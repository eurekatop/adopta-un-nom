---
import { sanitizeJsonLd } from "../lib/sanitizeJsonLd";
import FacebookLogin from '../components/FacebookLogin.astro';
import GTM from "../components/layout/GTM.astro";


/*
<!-- HTML Meta Tags -->
<title>¿Adivina la definición?</title>
<meta name="description" content="Juegos de palabras, para poner a prueba tus conocimientos. - Sistema cuasiestable formado por un electrón y su antipartícula, el positrón, unidos formando un átomo exótico. La órbita de ambas partículas y los niveles energéticos son similares a los del átomo de hidrógeno (formado por un protón y un electrón) pero debido a la diferente masa reducida del sistema, las frecuencias asociadas a las líneas espectrales son menos de la mitad que en el hidrógeno.">

<!-- Facebook Meta Tags -->
<meta property="og:url" content="https://www.eurekatop.com/wordguardian/es/game/1747937657998-857691-0755">
<meta property="og:type" content="website">
<meta property="og:title" content="¿Adivina la definición?">
<meta property="og:description" content="Juegos de palabras, para poner a prueba tus conocimientos. - Sistema cuasiestable formado por un electrón y su antipartícula, el positrón, unidos formando un átomo exótico. La órbita de ambas partículas y los niveles energéticos son similares a los del átomo de hidrógeno (formado por un protón y un electrón) pero debido a la diferente masa reducida del sistema, las frecuencias asociadas a las líneas espectrales son menos de la mitad que en el hidrógeno.">
<meta property="og:image" content="https://eurekatop.com/images/logo.png">

<!-- Twitter Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:domain" content="eurekatop.com">
<meta property="twitter:url" content="https://www.eurekatop.com/wordguardian/es/game/1747937657998-857691-0755">
<meta name="twitter:title" content="¿Adivina la definición?">
<meta name="twitter:description" content="Juegos de palabras, para poner a prueba tus conocimientos. - Sistema cuasiestable formado por un electrón y su antipartícula, el positrón, unidos formando un átomo exótico. La órbita de ambas partículas y los niveles energéticos son similares a los del átomo de hidrógeno (formado por un protón y un electrón) pero debido a la diferente masa reducida del sistema, las frecuencias asociadas a las líneas espectrales son menos de la mitad que en el hidrógeno.">
<meta name="twitter:image" content="https://eurekatop.com/images/logo.png">

<!-- Meta Tags Generated via https://www.opengraph.xyz -->
*/


const { lang = "ca", title, url, description, seed = "" } = Astro.props;

const translations = {
  ca: {
    game: "Jugar",
    ranking: "Puntuacions",
    info: "Com es juga",
    profile: "Perfil",
    lang: {
      ca: "Català",
      es: "Castellà",
      en: "Anglès",
    },
    share:"Comparteix aquesta partida",
    meta: {
      description:
        "Jocs de paraules, per possar a prova els teus coneixements.",
      image: "/images/logo.png",
      url: "https://www.eurekatop.com",
      type: "website",
      keywords: "joc, jocs, paraula, paraules, endevina, definicions, català",
    },
  },
  es: {
    game: "Jugar",
    ranking: "Puntuaciones",
    info: "Cómo se juega",
    profile: "Perfil",
    lang: {
      ca: "Catalán",
      es: "Español",
      en: "Inglés",
    },
    share:"Comparteix esta partida",
    meta: {
      description: "Juegos de palabras, para poner a prueba tus conocimientos.",
      image: "/images/logo.png",
      url: "https://www.eurekatop.com",
      type: "website",
      keywords: "juego, juegos, palabra, palabras, adivina, definiciones, español",
    },
  },
  en: {
    game: "Play",
    ranking: "Scores",
    info: "How to play",
    profile: "Profile",
    lang: {
      ca: "Catalan",
      es: "Spanish",
      en: "English",
    },
    share:"Share this game",
    meta: {
      description: "Word games, to test your knowledge.",
      image: "/images/logo.png",
      url: "https://www.eurekatop.com",
      type: "website",
      keywords: "game, games, word, words, guess, definitions, english",
    },
  },
};

const t = translations[lang as keyof typeof translations] ?? translations.ca;

const jsonLd = {
  "@context": "https://schema.org",
  "@type": "Game",
  "name": title,
  "description": `${t.meta.description}${description ? ` - ${description}` : ""}`,
  "url": `${t.meta.url}${url || ""}`,
  "inLanguage": lang,
  "image": `${t.meta.url}${import.meta.env.BASE_URL}api/img/og/${lang}/${seed}`,
  "genre": "word game",
  "educationalUse": "practice",
  "creator": {
    "@type": "Person",
    "name": "Francesc López Marió"
  }
};

const safeJsonLd = sanitizeJsonLd(jsonLd);
---

<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>{title}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={t.meta.description + (description ? ` - ${description}` : "")} />
    <meta name="keywords" content="joc, jocs, paraula, paraules, wordgames, words, juego, juegos, wordguardian" />
    <meta name="author" content="Francesc López Marió" />
    <meta name="robots" content="index,follow" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={t.meta.description + (description ? ` - ${description}` : "")}  />
    <meta property="og:image" content=`${t.meta.url}${import.meta.env.BASE_URL}api/img/og/${lang}/${seed}` />
    <meta property="og:url" content={ t.meta.url + ( url || "") } />
    <meta property="og:type" content="website" />
    
    <script type="application/ld+json" set:html={safeJsonLd}></script>


    <link rel="stylesheet" href=`${import.meta.env.BASE_URL}styles/global.css` />
    <link rel="stylesheet" href=`${import.meta.env.BASE_URL}styles/styles.css` />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png" data-next-head=""  />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png" data-next-head="" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png" data-next-head="" />
    <link rel="manifest" href="/favicon_io/site.webmanifest" data-next-head="" />

    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
    ></script>
  </head>
  <body>
    <GTM gtmId={import.meta.env.GOOGLE_GTM_ID || ""} gaId={import.meta.env.GOOGLE_GA_ID || ""} />

    <header>
      <h2>{title}</h2>
      <nav>
        <a href=`${import.meta.env.BASE_URL}${lang}/game`>{t.game}</a> |
        <a href=`${import.meta.env.BASE_URL}${lang}/ranking`>{t.ranking}</a> |
        <a href=`${import.meta.env.BASE_URL}${lang}/info`>{t.info}</a> |
        <a href=`${import.meta.env.BASE_URL}${lang}/profile`>{t.profile}</a>

        <select id="language-selector">
          <option value="ca" selected={lang === "ca"}>{t.lang.ca}</option>
          <option value="es" selected={lang === "es"}>{t.lang.es}</option>
          <option value="en" selected={lang === "en"}>{t.lang.en}</option>
        </select>

         <FacebookLogin appId="123456789012345" />
      </nav>
    </header>

    <main>
      <slot />
    </main>

    <script type="module">
      function shareToFacebook() {
        //const url = encodeURIComponent(window.location.href);
        const url = window.location.href;
        const fbUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
        window.open(fbUrl, "_blank", "noopener,noreferrer");
      }
      window.shareToFacebook = shareToFacebook; 

      function copyUrl() {
        navigator.clipboard
          .writeText(window.location.href)
          .then(() => {
            alert("Enllaç copiat al porta-retalls!");
          })
          .catch(() => {
            alert("No s'ha pogut copiar l'enllaç.");
          });
      }
      window.copyUrl = copyUrl; 
    </script>


    <footer
      style="margin-top: 3rem; padding: 1rem; text-align: center; border-top: 1px solid #ccc;"
    >
      <p>{t.share}</p>
      <button onclick="shareToFacebook()" style="margin-right: 0.5rem;"
        >📘 Facebook</button
      >
      <button onclick="copyUrl()">📋 Copy</button>
    </footer>

    <script>
      const selector = document.getElementById("language-selector");

      // Load language from localStorage if available
      const storedLang = localStorage.getItem("lang");
      if (storedLang) {
        selector.value = storedLang;
      }

      selector.addEventListener("change", () => {
        const lang = selector.value;
        localStorage.setItem("lang", lang);
        window.location.href = `${import.meta.env.BASE_URL}${lang}/game`;
      });
    </script>
  </body>
</html>


